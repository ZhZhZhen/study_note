# 安全问题

### 概要
- 首先最重要的是不要使用无法信赖的模板：确保Vue模板来源是可信的，并且完全由自己控制。因为模板会被编译成JS，而模板内的表达式在渲染过程会被执行，这样可能意外执行一些不期望的代码。
- 用户提供的内容（HTML，JavaScript，CSS）永远不能认为是100%安全的，除非它在iframe这样的沙盒环境中，或该内容只会被该用户看到。

### Vue自身的安全机制：
- 使用textContent对文本内容进行转义，从而防止脚本注入。
- 使用setAttribute对动态attribute绑定进行转义，从而防止脚本注入。
- Vue阻止了<style>{{userProviderStyles}}</style>这样的方式渲染style标签
*textContent/setAttribute是浏览器的原生API，如果浏览器本身有漏洞，则可能发生漏洞。

### 潜在的危险：
- 注入HTML：Vue提供了v-html属性来渲染html内容，这样做不会进行转义，所以不要将用户提供的内容用于该属性。运行用户编写的Vue模板也会带来类似危险。
- 注入URL：href属性中可以编写js代码执行js，所以如果使用了来源不明的URL，需要做URL无害化处理（可以使用库sanitize-url）。另外做了无害化处理的URL也不能保证它们指向安全的目的地。（URL无害化应该由服务端存储的时候处理，客户端展示的时候处理表明应用已经存在严重的安全问题）。
- 样式注入：可能通过style属性注入一个透明的导向另外一个网站的链接。建议仅在沙盒环境中允许用户控制CSS，或是仅提供特定的，能安全控制的属性并自己拼接对象传入style。
#4、JavaScript注入：任何时候都不要在Vue中渲染\<script>标签；避免给事件attribute绑定用户提供的内容（这些地方也可能会执行JS）；不要将Vue挂载到可能包含服务端渲染或用户提供内容的DOM节点上。